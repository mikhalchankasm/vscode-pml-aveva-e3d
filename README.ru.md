# PML –¥–ª—è AVEVA E3D ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ VS Code

–ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —è–∑—ã–∫–∞ PML (Programmable Macro Language) AVEVA E3D –≤ Visual Studio Code.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ (TextMate)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —è–∑—ã–∫–∞ (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Å–∫–æ–±–∫–∏, –ø—Ä–∞–≤–∏–ª–∞ –æ—Ç—Å—Ç—É–ø–æ–≤ –ø—Ä–∏ Enter)
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ—Ç—Å—Ç—É–ø—ã, –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏, –±–ª–æ–∫–∏ method/form/frame, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–π)
- IntelliSense: –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞, —Ç–∏–ø—ã, –∞—Ç—Ä–∏–±—É—Ç—ã, –º–µ—Ç–æ–¥—ã), –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (Signature Help)
- Hover‚Äë–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (JSDoc‚Äë–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞–¥ –º–µ—Ç–æ–¥–∞–º–∏)
- Outline (–æ–±–∑–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞): –º–µ—Ç–æ–¥—ã, –æ–±—ä–µ–∫—Ç—ã, —Ñ–æ—Ä–º—ã, —Ñ—Ä–µ–π–º—ã
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ –±–ª–æ–∫–∏, –±–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Command Palette): —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫, –æ–±—Ä–µ–∑–∫–∞ –ø—Ä–æ–±–µ–ª–æ–≤, —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–µ–π, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö/–º–µ—Ç–æ–¥–æ–≤
- –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é / –ü–æ–∏—Å–∫ —Å—Å—ã–ª–æ–∫ / –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ (–º–µ—Ç–æ–¥—ã)
- ‚ö° **Code Actions** (–ª–∞–º–ø–æ—á–∫–∞ üí°): –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ (`Ctrl+.`)
- üéØ **Quick Actions**: –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é —Å —á–∞—Å—Ç—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1) –ò–∑ VSIX (–ª–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞):
   - `npm install`
   - `npm run compile`
   - –°–±–æ—Ä–∫–∞: `npx vsce package`
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞: `code --install-extension pml-aveva-e3d-*.vsix`

2) –ò–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ (–æ—Ç–ª–∞–¥–∫–∞):
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–ø–∫—É –≤ VS Code –∏ –Ω–∞–∂–º–∏—Ç–µ `F5` –¥–ª—è Extension Development Host

## –¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤

- `.pml`, `.pmlobj`, `.pmlfnc`, `.pmlfrm`, `.pmlmac`, `.pmlcmd`

## –°–Ω–∏–ø–ø–µ—Ç—ã

- –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (if/then/else, —Ü–∏–∫–ª—ã)
- –ó–∞–≥–æ—Ç–æ–≤–∫–∏ –¥–ª—è UI (form/frame)
- –û–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –ø–æ–º–æ—â–Ω–∏–∫–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä–∞ (`settings.json`)

- `pml.formatter.indentSize` (—á–∏—Å–ª–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 4)
- `pml.formatter.removeMultipleEmptyLines` (boolean)
- `pml.formatter.formatMethodBlocks` (boolean)
- `pml.formatter.formatFormBlocks` (boolean)
- `pml.formatter.alignAssignments` (boolean)
- `pml.formatter.fixIndentation` (boolean)

## JSDoc‚Äë–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –†–∞–∑–º–µ—â–∞–π—Ç–µ —Å—Ç—Ä–æ–∫–∏ `--` –Ω–∞–¥ `define method .name()`
- –¢–µ–≥–∏: `@param`, `@return`, `@example`, `@deprecated`, `@author`, `@since`, `@see`, `@form`, `@callback`

## –ö–æ–º–∞–Ω–¥—ã (Command Palette)

- PML: Format PML Document
- PML Tools: Sort Lines A‚ÄëZ / Z‚ÄëA / by Length / Smart Natural Sort
- PML Tools: Remove Duplicates / Consecutive Duplicates / Empty Lines / Whitespace‚Äëonly Lines / Trim Trailing Whitespace / Tabs ‚Üî Spaces
- PML Tools: Extract Variables / Extract Methods / Remove Comments
- –ü–æ–∫–∞–∑–∞—Ç—å –º–µ—Ç–æ–¥—ã STRING/REAL/ARRAY/DBREF, –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã

## ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (Code Actions & Quick Menu)

–ü—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ 2+ —Å—Ç—Ä–æ–∫ –≤ PML —Ñ–∞–π–ª–µ –¥–æ—Å—Ç—É–ø–Ω—ã –±—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã:

**–°–ø–æ—Å–æ–± 1: –õ–∞–º–ø–æ—á–∫–∞ üí°**
- –í—ã–¥–µ–ª–∏ —Ç–µ–∫—Å—Ç ‚Üí –Ω–∞–∂–º–∏ `Ctrl+.` (–∏–ª–∏ –∫–ª–∏–∫–Ω–∏ –Ω–∞ –ª–∞–º–ø–æ—á–∫—É)
- –ö–æ–º–∞–Ω–¥—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

**–°–ø–æ—Å–æ–± 2: –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é**
- –í—ã–¥–µ–ª–∏ —Ç–µ–∫—Å—Ç ‚Üí –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí "‚ö° Quick Actions"
- –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –≤ PML —Ñ–∞–π–ª–∞—Ö

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- üìã Array: Make List (Path/String/Path String) ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ –∏–∑ —Å—Ç—Ä–æ–∫
- üî§ Sort: A‚ÜíZ, Z‚ÜíA, Smart Natural ‚Äî —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- üóëÔ∏è Remove: Duplicate Lines, Empty Lines ‚Äî –æ—á–∏—Å—Ç–∫–∞
- ‚úÇÔ∏è Trim: Trailing Whitespace ‚Äî –æ–±—Ä–µ–∑–∫–∞ –ø—Ä–æ–±–µ–ª–æ–≤

## –ë—ã—Å—Ç—Ä–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (Windows)

- –í–∞—Ä–∏–∞–Ω—Ç 1 (—Å–æ–±—Ä–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–±–æ—Ä–∫—É):
  ```powershell
  npm run pack:install
  ```
- –í–∞—Ä–∏–∞–Ω—Ç 2 (–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–±–æ—Ä–∫—É –±–µ–∑ —Å–±–æ—Ä–∫–∏):
  ```powershell
  npm run install:local
  ```
- –í–∞—Ä–∏–∞–Ω—Ç 3 (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è):
  ```powershell
  powershell -NoProfile -ExecutionPolicy Bypass -File scripts\reinstall.ps1 -Pack -Version 0.4.1
  ```

–°–∫—Ä–∏–ø—Ç `scripts/reinstall.ps1`:
- –ò—â–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π `pml-aveva-e3d-*.vsix` (–∏–ª–∏ `pml-aveva-e3d-<Version>.vsix` –ø—Ä–∏ `-Version`).
- –£–¥–∞–ª—è–µ—Ç —Ä–∞–Ω–µ–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è `mikhalchankasm.pml-aveva-e3d` –∏ `your-publisher-name.pml-aveva-e3d` –∏–∑ VS Code –∏ Cursor (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω CLI), –∑–∞—Ç–µ–º —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π `.vsix` —Å `--force`.
- –ü–∞—Ä–∞–º–µ—Ç—Ä `-Pack` –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –≤—ã–∑—ã–≤–∞–µ—Ç —Å–±–æ—Ä–∫—É VSIX (`npx @vscode/vsce package --no-yarn`).

–ü—Ä—è–º—ã–µ –∫–æ–º–∞–Ω–¥—ã (–±–µ–∑ npm‚Äë—Å–∫—Ä–∏–ø—Ç–æ–≤):
```powershell
# VS Code
code --uninstall-extension mikhalchankasm.pml-aveva-e3d 2>$null
code --uninstall-extension your-publisher-name.pml-aveva-e3d 2>$null
code --install-extension pml-aveva-e3d-0.4.1.vsix --force

# –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Cursor CLI, –º–æ–∂–Ω–æ –ø—Ä–æ–¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã —Å cursor:
cursor --uninstall-extension mikhalchankasm.pml-aveva-e3d 2>$null
cursor --uninstall-extension your-publisher-name.pml-aveva-e3d 2>$null
cursor --install-extension pml-aveva-e3d-0.4.1.vsix --force
```

–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:
- –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ `code` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –≤ PowerShell, –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏–∑ VS Code (Terminal ‚Üí New Terminal) –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ VS Code –≤ PATH, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±–æ–ª–æ—á–∫—É.
- `cursor` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Cursor CLI –∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ PATH ‚Äî –∏–Ω–∞—á–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç —à–∞–≥–∏ –¥–ª—è Cursor –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.


- –õ–∏–Ω—Ç: `npm run lint`
- –°–±–æ—Ä–∫–∞: `npm run compile`
- CI: GitHub Actions (lint + build –ø—Ä–∏ push/PR)
- –†–µ–ª–∏–∑: –ø—É—à—å—Ç–µ —Ç–µ–≥ `v*` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `v0.4.1`) ‚Äî —Å–æ–∑–¥–∞—Å—Ç—Å—è GitHub Release —Å VSIX

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –ü–æ–ª–Ω—ã–π –∏–Ω–¥–µ–∫—Å ‚Äî –≤ `docs/README.md`.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Visual Studio Code 1.80.0+

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –Ø–∑—ã–∫–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —á–∞—Å—Ç–∏—á–Ω–æ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ; —Å–æ–æ–±—â–∞–π—Ç–µ –æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è—Ö –≤ Issues.

## –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π

- –°–º. `docs/CHANGELOG.md` –∏ GitHub Releases.

## –õ–∏—Ü–µ–Ω–∑–∏—è

- MIT (—Å–º. LICENSE).

